<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ejemplo de WhatsApp Embed</title>
</head>
<body>

  <h1>Bienvenido a mi página</h1>
  <p>Este es un ejemplo de cómo incrustar el botón de WhatsApp.</p>

<!-- Escala embed whatsapp -->
<script id="escala-whatsapp-[LEAD_FORM_ID]-[RANDOM]" data-version="0.1.0">
  window["escala-whatsapp-[LEAD_FORM_ID]-[RANDOM]"] = {
    f: "[LEAD_FORM_ID]",
    r: "[RANDOM]",
    c: "[CUSTOMER_ID]",
    l: "es"
  };

  (function () {
    function escInitWhatsappImpl(opts) {
      const id = "escala-whatsapp-" + opts.f + "-" + opts.r;
      if (document.getElementById(id + "-loaded")) return;

      if (typeof jQuery === "undefined") {
        const jq = document.createElement("script");
        jq.src = "https://code.jquery.com/jquery-3.6.0.min.js";
        jq.type = "text/javascript";
        jq.onload = () => escInitWhatsappImpl(opts);
        document.head.appendChild(jq);
        return;
      }

      const preload = document.createElement("script");
      preload.type = "text/javascript";
      preload.innerHTML = `
        window.funnelPuppeteer = window.funnelPuppeteer || {};
        window.funnelPuppeteer.customerId = "${opts.c}";
      `;
      document.head.appendChild(preload);

      // Crear el botón
      const div = document.createElement("div");
      div.id = "escalaWhatsappButton";
      div.setAttribute("data-position", "right");
      div.setAttribute("data-phone", "[PHONE]");
      div.setAttribute("data-title", "[TITLE]");
      div.setAttribute("data-message", "[MESSAGE]");
      div.setAttribute("data-button", "[BUTTON]");
      div.setAttribute("data-auto-open-timeout", "0");
      div.setAttribute("data-closable", "true");

      const rawPlaceholders = `[PLACEHOLDER_ATTRS]`;
      rawPlaceholders.split('\n').forEach(p => {
        const parts = p.trim().split('=');
        if (parts.length >= 2) {
          const key = parts[0];
          const value = parts.slice(1).join('=');
          if (key && value) div.setAttribute(key, value.replace(/['"]/g, ''));
        }
      });

      // Cargar scripts después de definir funnelPuppeteer
      const script1 = document.createElement("script");
      script1.src = "https://[STYLES_DOMAIN]/plugins/whatsapp/whatsapp.js";
      script1.type = "text/javascript";

      const script2 = document.createElement("script");
      script2.src = "https://[STYLES_DOMAIN]/puppeteer/fpuppeteer.js";
      script2.type = "text/javascript";

      const marker = document.createElement("div");
      marker.id = id + "-loaded";

      document.body.appendChild(div);
      document.body.appendChild(script1);
      document.body.appendChild(script2);
      document.body.appendChild(marker);
    }

    function escInitWhatsapp() {
      const opts = window["escala-whatsapp-[LEAD_FORM_ID]-[RANDOM]"];
      if (!opts) return;
      escInitWhatsappImpl(opts);
    }

    if (document.readyState === "complete" || document.readyState === "interactive") {
      setTimeout(escInitWhatsapp, 1);
    } else if (window.addEventListener) {
      window.addEventListener("load", escInitWhatsapp, false);
    } else if (window.attachEvent) {
      window.attachEvent("onload", escInitWhatsapp);
    } else {
      window.onload = escInitWhatsapp;
    }
  })();
</script>
<!-- Escala embed whatsapp -->

</body>
</html>
